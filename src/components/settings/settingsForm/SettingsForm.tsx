import css from './SettingsForm.module.less';
import React, {useEffect, useRef, useState} from 'react';
import {merge} from "../../../lib/utils/arrayUtils";
import {useTranslation} from "react-i18next";
import Button, {ButtonStyle} from "../../button/Button";
import {store, toggleAntiAliasing, toggleOutlineEffect} from "../../../store/store";
import {gsap} from "gsap";

interface IProps {
    className?: string,
    onClose: () => void,
}

const componentName = "SettingsForm";
const debug = require("debug")(`front:${componentName}`);

enum QUALITY_LEVEL {
    HIGH_QUALITY,
    LOW_QUALITY
}

/**
 * Settings form which allows quality selection and save
 * @name SettingsForm
 */
function SettingsForm(props: IProps) {
    const {t} = useTranslation();
    // On récupère les paramètres antialiasing et outline effect
    const states = {...store.getState().user_data.settings};

    const [highQuality, toggleHighQuality] = useState<boolean>(store.getState().user_data.settings.outline);

    const check = useRef();
    const cross = useRef();

    useEffect(() => {
        if(highQuality) {
            gsap.from(check.current, {x: "0px", opacity: 1});
            gsap.from(cross.current, {x: "38px", opacity: 0});
        }
        else {
            gsap.from(check.current, {x: "-38px", opacity: 0});
            gsap.from(cross.current, {x: "0px", opacity: 1});
        }
    }, []);

    useEffect(() => {
        if(highQuality) {
            gsap.fromTo(check.current, {x: "-38px", opacity: 0}, {x: "0px", opacity: 1});
            gsap.fromTo(cross.current, {x: "0", opacity: 1}, {x: "38px", opacity: 0});
            store.dispatch(toggleOutlineEffect(true));
            store.dispatch(toggleAntiAliasing(true));
        }
        else {
            gsap.fromTo(check.current, {x: "0", opacity: 1}, {x: "-38px", opacity: 0});
            gsap.fromTo(cross.current, {x: "38px", opacity: 0}, {x: "0px", opacity: 1});
            store.dispatch(toggleOutlineEffect(false));
            store.dispatch(toggleAntiAliasing(false));
        }
    }, [highQuality]);

    return <div className={merge([css.root, props.className])}>
        <form>
            <label>Qualité élevée :</label>
            <div>
            <svg width="75px" height="38px" viewBox="0 0 75 38" version="1.1" onClick={() => { toggleHighQuality(!highQuality)}} >
                <g id="Groupe_2679" transform="matrix(1,0,0,1,-84.904,-271.851)">
                    <g id="bg" transform="matrix(1,0,0,1,2194.91,5649.15)">
                        <g id="Groupe_2673">
                            <g id="Groupe_2671">
                                <path id="Tracé_2567" d="M-2087.76,-5374.43L-2084.32,-5374.26L-2080.87,-5374.6L-2077.43,-5374.6L-2073.99,-5374.52L-2070.55,-5374.4L-2067.1,-5374.64L-2063.66,-5374.44L-2060.21,-5374.44L-2056.76,-5374.41L-2053.23,-5373.83L-2049.88,-5372.68L-2046.65,-5371.07L-2044.25,-5368.37L-2042.19,-5365.41L-2041.44,-5361.89L-2040.5,-5358.39L-2040.88,-5358.39L-2040.88,-5354.76L-2042.33,-5351.44L-2044.47,-5348.59L-2046.9,-5346.02L-2049.94,-5344.23L-2053.26,-5343.07L-2056.76,-5342.66L-2060.2,-5342.3L-2063.65,-5342.3L-2067.09,-5342.17L-2070.53,-5342.15L-2073.97,-5342.65L-2077.42,-5342.15L-2080.86,-5342.52L-2084.31,-5342.3L-2087.76,-5342.6L-2091.3,-5342.87L-2094.8,-5343.77L-2097.63,-5346.02L-2100.14,-5348.52L-2102.01,-5351.52L-2103.36,-5354.82L-2103.88,-5358.38L-2103.92,-5358.38L-2103.17,-5361.9L-2102.2,-5365.33L-2100.38,-5368.45L-2097.91,-5371.1L-2094.59,-5372.56L-2091.34,-5374.04L-2087.76,-5374.43Z" style={{fill: "white", fillRule:"nonzero"}}/>
                            </g>
                            <g id="Groupe_2672">
                                <path id="Tracé_2568" d="M-2087.76,-5373.8L-2084.32,-5373.65L-2080.87,-5373.86L-2077.43,-5373.75L-2073.99,-5373.65L-2070.55,-5374.05L-2067.1,-5373.8L-2063.66,-5373.7L-2060.21,-5374.17L-2056.76,-5373.61L-2053.27,-5373.68L-2049.99,-5372.44L-2047.23,-5370.34L-2044.75,-5367.96L-2042.6,-5365.21L-2041.82,-5361.8L-2041.07,-5358.39L-2041.27,-5358.39L-2041.87,-5354.99L-2042.92,-5351.72L-2044.56,-5348.65L-2047.1,-5346.27L-2049.96,-5344.28L-2053.36,-5343.5L-2056.76,-5342.72L-2060.21,-5342.66L-2063.65,-5343.16L-2067.09,-5342.85L-2070.53,-5342.67L-2073.97,-5342.98L-2077.42,-5342.66L-2080.86,-5342.8L-2084.31,-5342.7L-2087.76,-5343L-2091.15,-5343.55L-2094.6,-5344.19L-2097.59,-5346.07L-2100.11,-5348.54L-2101.63,-5351.71L-2102.85,-5354.94L-2102.98,-5358.39L-2103.08,-5358.39L-2102.92,-5361.85L-2101.62,-5365.06L-2100.05,-5368.19L-2097.56,-5370.68L-2094.55,-5372.48L-2091.22,-5373.52L-2087.76,-5373.8Z"  style={{fill: "white", fillRule:"nonzero", stroke: "rgb(32,45,64)", strokeWidth: "1px"}}/>
                            </g>
                        </g>
                    </g>
                    <g ref={check} id="check" transform="matrix(1,0,0,1,0.377,-0.479044)">
                        <g id="Groupe_2668" transform="matrix(1,0,0,1,123.122,272.831)">
                            <g id="Groupe_108">
                                <g id="Groupe_60">
                                    <g transform="matrix(1,0,0,1,-1278.66,319.301)">
                                        <g id="Groupe_58">
                                            <path id="Tracé_236" d="M1315.16,-300.151L1314.62,-297.051L1313.98,-293.989L1312.76,-291.082L1310.74,-288.664L1308.55,-286.45L1306.08,-284.529L1303.16,-283.378L1300.2,-282.306L1297.06,-281.98L1293.89,-282.212L1290.96,-283.39L1288.17,-284.756L1285.42,-286.279L1283.43,-288.717L1281.51,-291.173L1280.11,-293.981L1279.22,-297.004L1279.14,-300.149L1279.36,-303.269L1280.32,-306.238L1281.6,-309.07L1283.33,-311.67L1285.5,-313.923L1288.04,-315.759L1290.94,-316.93L1293.92,-317.878L1297.05,-317.941L1300.16,-317.785L1303.14,-316.897L1306.1,-315.823L1308.72,-314.058L1310.72,-311.617L1312.71,-309.189L1314.01,-306.322L1314.69,-303.261L1315.16,-300.151Z" style={{fillRule:"nonzero", fill: "rgb(32,45,64)"}}/>
                                        </g>
                                    </g>
                                    <g id="Groupe_59">
                                        <g id="Tracé_237" transform="matrix(1,0,0,1,-1278.08,320.94)">
                                            <path d="M1314.11,-303.151L1313.56,-300.051L1312.92,-296.989L1311.7,-294.082L1309.69,-291.664L1307.49,-289.45L1305.02,-287.529L1302.1,-286.378L1299.15,-285.306L1296,-284.98L1292.84,-285.212L1289.9,-286.39L1287.11,-287.756L1284.36,-289.279L1282.38,-291.717L1280.45,-294.173L1279.05,-296.981L1278.16,-300.003L1278.08,-303.148L1278.3,-306.269L1279.27,-309.238L1280.54,-312.07L1282.27,-314.67L1284.44,-316.923L1286.99,-318.759L1289.89,-319.93L1292.87,-320.878L1295.99,-320.941L1299.1,-320.785L1302.09,-319.897L1305.04,-318.823L1307.66,-317.058L1309.66,-314.617L1311.65,-312.189L1312.95,-309.322L1313.63,-306.261L1314.11,-303.151Z" style={{fillRule:"nonzero", fill: "rgb(238,231,217)"}}/>
                                        </g>
                                        <g id="Tracé_238" transform="matrix(1,0,0,1,-1278.08,320.94)">
                                            <path d="M1314.11,-303.151L1313.56,-300.051L1312.92,-296.989L1311.7,-294.082L1309.69,-291.664L1307.49,-289.45L1305.02,-287.529L1302.1,-286.378L1299.15,-285.306L1296,-284.98L1292.84,-285.212L1289.9,-286.39L1287.11,-287.756L1284.36,-289.279L1282.38,-291.717L1280.45,-294.173L1279.05,-296.981L1278.16,-300.003L1278.08,-303.148L1278.3,-306.269L1279.27,-309.238L1280.54,-312.07L1282.27,-314.67L1284.44,-316.923L1286.99,-318.759L1289.89,-319.93L1292.87,-320.878L1295.99,-320.941L1299.1,-320.785L1302.09,-319.897L1305.04,-318.823L1307.66,-317.058L1309.66,-314.617L1311.65,-312.189L1312.95,-309.322L1313.63,-306.261L1314.11,-303.151Z" style={{fill: "none", fillRule:"nonzero", stroke: "rgb(32,45,64)", strokeWidth: "1px", strokeMiterlimit: 10}}/>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                        <g transform="matrix(0.996,-0.087,0.087,0.996,92.5779,228.047)">
                            <g id="Groupe_2442">
                                <g id="Groupe_2441">
                                    <g id="Groupe_2440">
                                        <g id="Groupe_2439">
                                            <path id="Tracé_2523" d="M48.238,62.141C44.962,63.087 42.397,66.224 40.638,69.195L38.677,66.543C37.982,65.603 36.388,66.518 37.092,67.47L39.953,71.34C40.122,71.615 40.423,71.783 40.745,71.783C41.068,71.783 41.369,71.615 41.538,71.34C42.156,70.201 42.864,69.112 43.655,68.085C44.955,66.385 46.607,64.526 48.729,63.913C49.126,63.803 49.403,63.439 49.403,63.027C49.403,62.523 48.988,62.108 48.483,62.108C48.401,62.108 48.318,62.119 48.238,62.141Z"  style={{ fillRule:"nonzero", fill: "rgb(32,45,64)"}}/>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                    </g>
                    <g ref={cross} id="cross" transform="matrix(1,0,0,1,-0.796,-0.479044)">
                        <g id="Groupe_2668-2" transform="matrix(1,0,0,1,86.204,272.831)">
                            <g id="Groupe_108-2">
                                <g id="Groupe_60-2">
                                    <g transform="matrix(1,0,0,1,-1278.66,319.301)">
                                        <g id="Groupe_58-2">
                                            <path id="Tracé_236-2" d="M1315.16,-300.151L1314.62,-297.051L1313.98,-293.989L1312.76,-291.082L1310.74,-288.664L1308.55,-286.45L1306.08,-284.529L1303.16,-283.378L1300.2,-282.306L1297.06,-281.98L1293.89,-282.212L1290.96,-283.39L1288.17,-284.756L1285.42,-286.279L1283.43,-288.717L1281.51,-291.173L1280.11,-293.981L1279.22,-297.004L1279.14,-300.149L1279.36,-303.269L1280.32,-306.238L1281.6,-309.07L1283.33,-311.67L1285.5,-313.923L1288.04,-315.759L1290.94,-316.93L1293.92,-317.878L1297.05,-317.941L1300.16,-317.785L1303.14,-316.897L1306.1,-315.823L1308.72,-314.058L1310.72,-311.617L1312.71,-309.189L1314.01,-306.322L1314.69,-303.261L1315.16,-300.151Z"  style={{fillRule:"nonzero", fill: "rgb(32,45,64)"}}/>
                                        </g>
                                    </g>
                                    <g id="Groupe_59-2">
                                        <g id="Tracé_237-2" transform="matrix(1,0,0,1,-1278.08,320.94)">
                                            <path d="M1314.11,-303.151L1313.56,-300.051L1312.92,-296.989L1311.7,-294.082L1309.69,-291.664L1307.49,-289.45L1305.02,-287.529L1302.1,-286.378L1299.15,-285.306L1296,-284.98L1292.84,-285.212L1289.9,-286.39L1287.11,-287.756L1284.36,-289.279L1282.38,-291.717L1280.45,-294.173L1279.05,-296.981L1278.16,-300.003L1278.08,-303.148L1278.3,-306.269L1279.27,-309.238L1280.54,-312.07L1282.27,-314.67L1284.44,-316.923L1286.99,-318.759L1289.89,-319.93L1292.87,-320.878L1295.99,-320.941L1299.1,-320.785L1302.09,-319.897L1305.04,-318.823L1307.66,-317.058L1309.66,-314.617L1311.65,-312.189L1312.95,-309.322L1313.63,-306.261L1314.11,-303.151Z"  style={{fill: "white", fillRule:"nonzero"}}/>
                                        </g>
                                        <g id="Tracé_238-2" transform="matrix(1,0,0,1,-1278.08,320.94)">
                                            <path d="M1314.11,-303.151L1313.56,-300.051L1312.92,-296.989L1311.7,-294.082L1309.69,-291.664L1307.49,-289.45L1305.02,-287.529L1302.1,-286.378L1299.15,-285.306L1296,-284.98L1292.84,-285.212L1289.9,-286.39L1287.11,-287.756L1284.36,-289.279L1282.38,-291.717L1280.45,-294.173L1279.05,-296.981L1278.16,-300.003L1278.08,-303.148L1278.3,-306.269L1279.27,-309.238L1280.54,-312.07L1282.27,-314.67L1284.44,-316.923L1286.99,-318.759L1289.89,-319.93L1292.87,-320.878L1295.99,-320.941L1299.1,-320.785L1302.09,-319.897L1305.04,-318.823L1307.66,-317.058L1309.66,-314.617L1311.65,-312.189L1312.95,-309.322L1313.63,-306.261L1314.11,-303.151Z"  style={{fill: "none", fillRule:"nonzero", stroke: "rgb(32,45,64)", strokeWidth: "1px", strokeMiterlimit: 10}}/>
                                        </g>
                                    </g>
                                </g>
                            </g>
                        </g>
                        <g id="_" transform="matrix(0.707107,0.707107,-0.707107,0.707107,93.85,291.49)">
                            <text x="0px" y="0px" style={  {fontFamily: 'MFeltPen HK', fontSize:"20px", fill:"rgb(34,45,64)"}}>+</text>
                        </g>
                    </g>
                </g>
            </svg>
            </div>
        </form>
    </div>
}

export default SettingsForm
